// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Belt_List = require("bs-platform/lib/js/belt_List.js");
var Belt_Array = require("bs-platform/lib/js/belt_Array.js");
var Pervasives = require("bs-platform/lib/js/pervasives.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Util$AgdaModeVscode = require("./Util/Util.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");
var Parser$AgdaModeVscode = require("./Parser.bs.js");

function parse(param) {
  switch (param) {
    case "argument" :
        return /* Argument */32;
    case "background" :
        return /* Background */7;
    case "bound" :
        return /* Bound */21;
    case "catchallclause" :
        return /* CatchallClause */19;
    case "coinductiveconstructor" :
        return /* ConstructorCoInductive */24;
    case "comment" :
        return /* Comment */0;
    case "confluenceproblem" :
        return /* ConfluenceProblem */20;
    case "coverageproblem" :
        return /* CoverageProblem */16;
    case "datatype" :
        return /* Datatype */25;
    case "deadcode" :
        return /* Deadcode */15;
    case "dottedpattern" :
        return /* DottedPattern */10;
    case "error" :
        return /* Error */9;
    case "field" :
        return /* Field */26;
    case "function" :
        return /* Function */27;
    case "generalizable" :
        return /* Generalizable */22;
    case "incompletepattern" :
        return /* IncompletePattern */17;
    case "inductiveconstructor" :
        return /* ConstructorInductive */23;
    case "keyword" :
        return /* Keyword */1;
    case "macro" :
        return /* Macro */33;
    case "markup" :
        return /* Markup */8;
    case "module" :
        return /* Module */28;
    case "number" :
        return /* Number */3;
    case "operator" :
        return /* Operator */34;
    case "positivityproblem" :
        return /* PositivityProblem */14;
    case "postulate" :
        return /* Postulate */29;
    case "pragma" :
        return /* Pragma */6;
    case "primitive" :
        return /* Primitive */30;
    case "primitivetype" :
        return /* PrimitiveType */5;
    case "record" :
        return /* Record */31;
    case "string" :
        return /* String */2;
    case "symbol" :
        return /* Symbol */4;
    case "terminationproblem" :
        return /* TerminationProblem */13;
    case "typechecks" :
        return /* TypeChecks */18;
    case "unsolpedmeta" :
        return /* UnsolvedMeta */11;
    case "unsolvedconstraint" :
        return /* UnsolvedConstraint */12;
    default:
      return /* Operator */34;
  }
}

function toStyle(param) {
  switch (param) {
    case /* Keyword */1 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#CD6600"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#FF9932"])
                ]);
    case /* String */2 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#B22222"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#DD4D4D"])
                ]);
    case /* Number */3 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#800080"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#9010E0"])
                ]);
    case /* Symbol */4 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#404040"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#BFBFBF"])
                ]);
    case /* Error */9 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#FF0000"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#FF0000"])
                ]);
    case /* UnsolvedMeta */11 :
    case /* UnsolvedConstraint */12 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#FFFF00"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#806B00"])
                ]);
    case /* TerminationProblem */13 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#FFA07A"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#802400"])
                ]);
    case /* PositivityProblem */14 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#CD853F"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#803F00"])
                ]);
    case /* Deadcode */15 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#A9A9A9"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#808080"])
                ]);
    case /* CoverageProblem */16 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#F5DEB3"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#805300"])
                ]);
    case /* IncompletePattern */17 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#800080"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#800080"])
                ]);
    case /* CatchallClause */19 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#F5F5F5"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#404040"])
                ]);
    case /* ConfluenceProblem */20 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#FFC0CB"]),
                  /* Background */Caml_chrome_debugger.variant("Background", 0, ["#800080"])
                ]);
    case /* ConstructorInductive */23 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#008B00"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#29CC29"])
                ]);
    case /* ConstructorCoInductive */24 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#996600"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#FFEA75"])
                ]);
    case /* Field */26 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#EE1289"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#F570B7"])
                ]);
    case /* Module */28 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#800080"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#CD80FF"])
                ]);
    case /* PrimitiveType */5 :
    case /* Datatype */25 :
    case /* Function */27 :
    case /* Postulate */29 :
    case /* Primitive */30 :
    case /* Record */31 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#0000CD"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#8080FF"])
                ]);
    case /* Macro */33 :
        return /* Themed */Caml_chrome_debugger.simpleVariant("Themed", [
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#458B74"]),
                  /* Foreground */Caml_chrome_debugger.variant("Foreground", 1, ["#73BAA2"])
                ]);
    case /* Comment */0 :
    case /* Pragma */6 :
    case /* Background */7 :
    case /* Markup */8 :
    case /* DottedPattern */10 :
    case /* TypeChecks */18 :
    case /* Bound */21 :
    case /* Generalizable */22 :
    case /* Argument */32 :
    case /* Operator */34 :
        return /* Noop */0;
    
  }
}

var Aspect = {
  parse: parse,
  toStyle: toStyle
};

function toString(self) {
  var match = self.source;
  return "Annotation " + (String(self.start) + (" " + (String(self.end_) + (" " + (Util$AgdaModeVscode.Pretty.list(Belt_List.fromArray(self.aspects)) + (
                    match !== undefined ? match[0] + (" " + String(match[1])) : ""
                  ))))));
}

function parse$1(xs) {
  if (!xs.tag) {
    return ;
  }
  var xs$1 = xs[0];
  var len = xs$1.length;
  if (len >= 7) {
    return ;
  }
  switch (len) {
    case 3 :
        var start$prime = xs$1[0];
        if (start$prime.tag) {
          return ;
        }
        var end_$prime = xs$1[1];
        if (end_$prime.tag) {
          return ;
        }
        var end_$prime$1 = end_$prime[0];
        var aspects = xs$1[2];
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$prime[0]), (function (start) {
                      return Belt_Option.map(Pervasives.int_of_string_opt(end_$prime$1), (function (end_) {
                                    return {
                                            start: start - 1 | 0,
                                            end_: end_ - 1 | 0,
                                            aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects), parse),
                                            source: undefined
                                          };
                                  }));
                    }));
    case 4 :
        var start$prime$1 = xs$1[0];
        if (start$prime$1.tag) {
          return ;
        }
        var end_$prime$2 = xs$1[1];
        if (end_$prime$2.tag) {
          return ;
        }
        var end_$prime$3 = end_$prime$2[0];
        var aspects$1 = xs$1[2];
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$prime$1[0]), (function (start) {
                      return Belt_Option.map(Pervasives.int_of_string_opt(end_$prime$3), (function (end_) {
                                    return {
                                            start: start - 1 | 0,
                                            end_: end_ - 1 | 0,
                                            aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects$1), parse),
                                            source: undefined
                                          };
                                  }));
                    }));
    case 0 :
    case 1 :
    case 2 :
    case 5 :
        return ;
    case 6 :
        var start$prime$2 = xs$1[0];
        if (start$prime$2.tag) {
          return ;
        }
        var end_$prime$4 = xs$1[1];
        if (end_$prime$4.tag) {
          return ;
        }
        var end_$prime$5 = end_$prime$4[0];
        var aspects$2 = xs$1[2];
        var match = xs$1[5];
        if (!match.tag) {
          return ;
        }
        var match$1 = match[0];
        if (match$1.length !== 3) {
          return ;
        }
        var filepath = match$1[0];
        if (filepath.tag) {
          return ;
        }
        var filepath$1 = filepath[0];
        var index$prime = match$1[2];
        if (index$prime.tag) {
          return ;
        }
        var index$prime$1 = index$prime[0];
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$prime$2[0]), (function (start) {
                      return Belt_Option.flatMap(Pervasives.int_of_string_opt(end_$prime$5), (function (end_) {
                                    return Belt_Option.map(Pervasives.int_of_string_opt(index$prime$1), (function (index) {
                                                  return {
                                                          start: start - 1 | 0,
                                                          end_: end_ - 1 | 0,
                                                          aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects$2), parse),
                                                          source: /* tuple */[
                                                            filepath$1,
                                                            index
                                                          ]
                                                        };
                                                }));
                                  }));
                    }));
    
  }
}

function parseDirectHighlightings(tokens) {
  return Belt_Array.keepMap(Belt_Array.map(tokens.slice(2), parse$1), (function (x) {
                return x;
              }));
}

function parseIndirectHighlightings(tokens) {
  return Belt_Array.keepMap(Belt_Array.map(tokens.slice(1), parse$1), (function (x) {
                return x;
              }));
}

var Token;

exports.Aspect = Aspect;
exports.Token = Token;
exports.toString = toString;
exports.parse = parse$1;
exports.parseDirectHighlightings = parseDirectHighlightings;
exports.parseIndirectHighlightings = parseIndirectHighlightings;
/* Util-AgdaModeVscode Not a pure module */
