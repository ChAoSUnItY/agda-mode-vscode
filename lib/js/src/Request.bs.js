// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Belt_Array = require("bs-platform/lib/js/belt_Array.js");
var Pervasives = require("bs-platform/lib/js/pervasives.js");
var Goal$AgdaModeVscode = require("./Goal.bs.js");
var Util$AgdaModeVscode = require("./Util/Util.bs.js");
var Parser$AgdaModeVscode = require("./Parser.bs.js");
var Command$AgdaModeVscode = require("./Command.bs.js");

function encode($$document, version, filepath, backend, libraryPath, highlightingMethod, request) {
  libraryPath.unshift(".");
  var libraryPath$1 = Belt_Array.map(libraryPath, (function (x) {
            return "\"" + (Parser$AgdaModeVscode.filepath(x) + "\"");
          })).join(", ");
  var highlightingMethod$1 = highlightingMethod ? "Direct" : "Indirect";
  var commonPart = function (level) {
    var level$1;
    switch (level) {
      case /* None */0 :
          level$1 = "None";
          break;
      case /* NonInteractive */1 :
          level$1 = "NonInteractive";
          break;
      case /* Interactive */2 :
          level$1 = "Interactive";
          break;
      
    }
    return "IOTCM \"" + (filepath + ("\" " + (level$1 + (" " + highlightingMethod$1))));
  };
  var buildRange = function (goal) {
    if (Util$AgdaModeVscode.Version.gte(version, "2.5.1")) {
      return Goal$AgdaModeVscode.buildHaskellRange($$document, goal, false, filepath);
    } else {
      return Goal$AgdaModeVscode.buildHaskellRange($$document, goal, true, filepath);
    }
  };
  if (typeof request === "number") {
    switch (request) {
      case /* Load */0 :
          if (Util$AgdaModeVscode.Version.gte(version, "2.5.0")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_load \"" + (String(filepath) + "\" [] )"));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_load \"" + (String(filepath) + ("\" [" + (String(libraryPath$1) + "] )"))));
          }
      case /* Compile */1 :
          if (Util$AgdaModeVscode.Version.gte(version, "2.5.0")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compile " + (String(backend) + (" \"" + (String(filepath) + "\" [] )"))));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compile " + (String(backend) + (" \"" + (String(filepath) + ("\" [" + (String(libraryPath$1) + "] )"))))));
          }
      case /* ToggleDisplayOfImplicitArguments */2 :
          return commonPart(/* NonInteractive */1) + "( ToggleImplicitArgs )";
      case /* ShowConstraints */3 :
          return commonPart(/* NonInteractive */1) + "( Cmd_constraints )";
      case /* ShowGoals */4 :
          return commonPart(/* NonInteractive */1) + "( Cmd_metas )";
      
    }
  } else {
    switch (request.tag | 0) {
      case /* SolveConstraints */0 :
          var normalization = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var index = String(request[1].index);
          return commonPart(/* NonInteractive */1) + ("( Cmd_solveOne " + (String(normalization) + (" " + (String(index) + " noRange \"\" )"))));
      case /* SolveConstraintsGlobal */1 :
          var normalization$1 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_solveAll " + (String(normalization$1) + " )"));
      case /* SearchAbout */2 :
          var normalization$2 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_search_about_toplevel " + (String(normalization$2) + (" \"" + (String(content) + "\" )"))));
      case /* Give */3 :
          var goal = request[0];
          var index$1 = String(goal.index);
          var content$1 = Goal$AgdaModeVscode.getContent(goal, $$document);
          var range = buildRange(goal);
          if (Util$AgdaModeVscode.Version.gte(version, "2.5.3")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_give WithoutForce " + (String(index$1) + (" " + (String(range) + (" \"" + (String(content$1) + "\" )"))))));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_give " + (String(index$1) + (" " + (String(range) + (" \"" + (String(content$1) + "\" )"))))));
          }
      case /* Refine */4 :
          var goal$1 = request[0];
          var index$2 = String(goal$1.index);
          var content$2 = Goal$AgdaModeVscode.getContent(goal$1, $$document);
          var range$1 = buildRange(goal$1);
          return commonPart(/* NonInteractive */1) + ("( Cmd_refine_or_intro False " + (String(index$2) + (" " + (String(range$1) + (" \"" + (String(content$2) + "\" )"))))));
      case /* ElaborateAndGive */5 :
          var index$3 = String(request[2].index);
          var normalization$3 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$3 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_elaborate_give " + (String(normalization$3) + (" " + (String(index$3) + (" noRange \"" + (String(content$3) + "\" )"))))));
      case /* Auto */6 :
          var goal$2 = request[0];
          var index$4 = String(goal$2.index);
          var content$4 = Goal$AgdaModeVscode.getContent(goal$2, $$document);
          var range$2 = buildRange(goal$2);
          if (Util$AgdaModeVscode.Version.gte(version, "2.6.0.1")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_autoOne " + (String(index$4) + (" " + (String(range$2) + (" \"" + (String(content$4) + "\" )"))))));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_auto " + (String(index$4) + (" " + (String(range$2) + (" \"" + (String(content$4) + "\" )"))))));
          }
      case /* Case */7 :
          var goal$3 = request[0];
          var index$5 = String(goal$3.index);
          var content$5 = Goal$AgdaModeVscode.getContent(goal$3, $$document);
          var range$3 = buildRange(goal$3);
          return commonPart(/* NonInteractive */1) + ("( Cmd_make_case " + (String(index$5) + (" " + (String(range$3) + (" \"" + (String(content$5) + "\" )"))))));
      case /* HelperFunctionType */8 :
          var index$6 = String(request[2].index);
          var normalization$4 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$6 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_helper_function " + (String(normalization$4) + (" " + (String(index$6) + (" noRange \"" + (String(content$6) + "\" )"))))));
      case /* InferType */9 :
          var index$7 = String(request[2].index);
          var normalization$5 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$7 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_infer " + (String(normalization$5) + (" " + (String(index$7) + (" noRange \"" + (String(content$7) + "\" )"))))));
      case /* InferTypeGlobal */10 :
          var normalization$6 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$8 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* None */0) + ("( Cmd_infer_toplevel " + (String(normalization$6) + (" \"" + (String(content$8) + "\" )"))));
      case /* Context */11 :
          var index$8 = String(request[1].index);
          var normalization$7 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_context " + (String(normalization$7) + (" " + (String(index$8) + " noRange \"\" )"))));
      case /* GoalType */12 :
          var index$9 = String(request[1].index);
          var normalization$8 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_goal_type " + (String(normalization$8) + (" " + (String(index$9) + " noRange \"\" )"))));
      case /* GoalTypeAndContext */13 :
          var index$10 = String(request[1].index);
          var normalization$9 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_goal_type_context " + (String(normalization$9) + (" " + (String(index$10) + " noRange \"\" )"))));
      case /* GoalTypeContextAndInferredType */14 :
          var index$11 = String(request[2].index);
          var normalization$10 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$9 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_goal_type_context_infer " + (String(normalization$10) + (" " + (String(index$11) + (" noRange \"" + (String(content$9) + "\" )"))))));
      case /* GoalTypeContextAndCheckedType */15 :
          var index$12 = String(request[2].index);
          var normalization$11 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$10 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_goal_type_context_check " + (String(normalization$11) + (" " + (String(index$12) + (" noRange \"" + (String(content$10) + "\" )"))))));
      case /* ModuleContents */16 :
          var index$13 = String(request[2].index);
          var normalization$12 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$11 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_show_module_contents " + (String(normalization$12) + (" " + (String(index$13) + (" noRange \"" + (String(content$11) + "\" )"))))));
      case /* ModuleContentsGlobal */17 :
          var normalization$13 = Command$AgdaModeVscode.Normalization.encode(request[0]);
          var content$12 = Parser$AgdaModeVscode.userInput(request[1]);
          return commonPart(/* None */0) + ("( Cmd_show_module_contents_toplevel " + (String(normalization$13) + (" \"" + (String(content$12) + "\" )"))));
      case /* ComputeNormalForm */18 :
          var computeMode = request[0];
          var index$14 = String(request[2].index);
          var ignoreAbstract = Pervasives.string_of_bool(Command$AgdaModeVscode.ComputeMode.ignoreAbstract(computeMode));
          var computeMode$1 = Command$AgdaModeVscode.ComputeMode.encode(computeMode);
          var content$13 = Parser$AgdaModeVscode.userInput(request[1]);
          if (Util$AgdaModeVscode.Version.gte(version, "2.5.2")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compute " + (String(computeMode$1) + (" " + (String(index$14) + (" noRange \"" + (String(content$13) + "\" )"))))));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compute " + (String(ignoreAbstract) + (" " + (String(index$14) + (" noRange \"" + (String(content$13) + "\" )"))))));
          }
      case /* ComputeNormalFormGlobal */19 :
          var computeMode$2 = request[0];
          var ignoreAbstract$1 = Pervasives.string_of_bool(Command$AgdaModeVscode.ComputeMode.ignoreAbstract(computeMode$2));
          var computeMode$3 = Command$AgdaModeVscode.ComputeMode.encode(computeMode$2);
          var content$14 = Parser$AgdaModeVscode.userInput(request[1]);
          if (Util$AgdaModeVscode.Version.gte(version, "2.5.2")) {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compute_toplevel " + (String(computeMode$3) + (" \"" + (String(content$14) + "\" )"))));
          } else {
            return commonPart(/* NonInteractive */1) + ("( Cmd_compute_toplevel " + (String(ignoreAbstract$1) + (" \"" + (String(content$14) + "\" )"))));
          }
      case /* WhyInScope */20 :
          var index$15 = String(request[1].index);
          var content$15 = Parser$AgdaModeVscode.userInput(request[0]);
          return commonPart(/* NonInteractive */1) + ("( Cmd_why_in_scope " + (String(index$15) + (" noRange \"" + (String(content$15) + "\" )"))));
      case /* WhyInScopeGlobal */21 :
          var content$16 = Parser$AgdaModeVscode.userInput(request[0]);
          return commonPart(/* None */0) + ("( Cmd_why_in_scope_toplevel \"" + (String(content$16) + "\" )"));
      
    }
  }
}

var VSRange;

exports.VSRange = VSRange;
exports.encode = encode;
/* Goal-AgdaModeVscode Not a pure module */
