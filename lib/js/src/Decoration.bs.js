// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Belt_Array = require("bs-platform/lib/js/belt_Array.js");
var Highlighting$AgdaModeVscode = require("./Highlighting.bs.js");

function Impl(Editor) {
  var decorateHole = function (editor, param, index) {
    var end_ = param[1];
    var start = param[0];
    var backgroundRange = Curry._2(Editor.$$Range.make, Curry._2(Editor.pointAtOffset, editor, start), Curry._2(Editor.pointAtOffset, editor, end_));
    var background = Curry._3(Editor.Decoration.highlightBackground, editor, "editor.selectionHighlightBackground", backgroundRange);
    var indexText = String(index);
    var indexRange = Curry._2(Editor.$$Range.make, Curry._2(Editor.pointAtOffset, editor, start), Curry._2(Editor.pointAtOffset, editor, end_ - 2 | 0));
    var index$1 = Curry._4(Editor.Decoration.overlayText, editor, "editorLightBulb.foreground", indexText, indexRange);
    return /* tuple */[
            background,
            index$1
          ];
  };
  var decorateAspect = function (editor, range, aspect) {
    var style = Highlighting$AgdaModeVscode.Aspect.toStyle(aspect);
    var decorate = function (color) {
      if (color.tag) {
        return Curry._3(Editor.Decoration.decorateTextWithColor, editor, color[0], range);
      } else {
        return Curry._3(Editor.Decoration.highlightBackgroundWithColor, editor, color[0], range);
      }
    };
    if (style) {
      if (Curry._1(Editor.colorThemeIsDark, undefined)) {
        return [/* tuple */[
                  decorate(style[1]),
                  range
                ]];
      } else {
        return [/* tuple */[
                  decorate(style[0]),
                  range
                ]];
      }
    } else {
      return [];
    }
  };
  var decorateHighlighting = function (editor, highlighting) {
    var start = Curry._3(Editor.fromAgdaOffset, editor, undefined, highlighting.start);
    var end_ = Curry._3(Editor.fromAgdaOffset, editor, undefined, highlighting.end_);
    var start$1 = Curry._2(Editor.pointAtOffset, editor, start);
    var end_$1 = Curry._2(Editor.pointAtOffset, editor, end_);
    var normalize = function (point) {
      var useCRLF = Curry._1(Editor.lineEndingIsCRLF, editor);
      if (!useCRLF) {
        return point;
      }
      var skippedCRLF = Curry._1(Editor.Point.line, point);
      return Curry._3(Editor.Point.translate, point, 0, skippedCRLF);
    };
    var range = Curry._2(Editor.$$Range.make, normalize(start$1), normalize(end_$1));
    return Belt_Array.concatMany(Belt_Array.map(highlighting.aspects, (function (param) {
                      return decorateAspect(editor, range, param);
                    })));
  };
  return {
          decorateHole: decorateHole,
          decorateAspect: decorateAspect,
          decorateHighlighting: decorateHighlighting
        };
}

exports.Impl = Impl;
/* Highlighting-AgdaModeVscode Not a pure module */
