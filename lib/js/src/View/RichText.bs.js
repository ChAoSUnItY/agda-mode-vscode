// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var React = require("react");
var $$String = require("bs-platform/lib/js/string.js");
var Belt_List = require("bs-platform/lib/js/belt_List.js");
var Belt_Array = require("bs-platform/lib/js/belt_Array.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Json_encode = require("@glennsl/bs-json/lib/js/src/Json_encode.bs.js");
var Util$AgdaModeVscode = require("../Util/Util.bs.js");
var Common$AgdaModeVscode = require("../Common.bs.js");
var Component__Link$AgdaModeVscode = require("./Component/Component__Link.bs.js");

function decode(param) {
  return Json_decode.array(Json_decode.string, param);
}

function encode(param) {
  return Json_encode.array((function (prim) {
                return prim;
              }), param);
}

var ClassNames = {
  decode: decode,
  encode: encode
};

function decode$1(param) {
  return Util$AgdaModeVscode.Decode.sum(function (x) {
              switch (x) {
                case "Hole" :
                    return {
                            TAG: 0,
                            _0: (function (param) {
                                return Json_decode.map((function (i) {
                                              return {
                                                      TAG: 3,
                                                      _0: i,
                                                      [Symbol.for("name")]: "Hole"
                                                    };
                                            }), Json_decode.$$int, param);
                              }),
                            [Symbol.for("name")]: "Contents"
                          };
                case "Icon" :
                    return {
                            TAG: 0,
                            _0: (function (param) {
                                return Json_decode.map((function (param) {
                                              return {
                                                      TAG: 0,
                                                      _0: param[0],
                                                      _1: param[1],
                                                      [Symbol.for("name")]: "Icon"
                                                    };
                                            }), (function (param) {
                                              return Json_decode.pair(Json_decode.string, decode, param);
                                            }), param);
                              }),
                            [Symbol.for("name")]: "Contents"
                          };
                case "Link" :
                    var partial_arg = decode$1(undefined);
                    var partial_arg$1 = function (param) {
                      return Json_decode.array(partial_arg, param);
                    };
                    var partial_arg$2 = function (param) {
                      return Json_decode.tuple3(Common$AgdaModeVscode.AgdaRange.decode, partial_arg$1, decode, param);
                    };
                    return {
                            TAG: 0,
                            _0: (function (param) {
                                return Json_decode.map((function (param) {
                                              return {
                                                      TAG: 2,
                                                      _0: param[0],
                                                      _1: param[1],
                                                      _2: param[2],
                                                      [Symbol.for("name")]: "Link"
                                                    };
                                            }), partial_arg$2, param);
                              }),
                            [Symbol.for("name")]: "Contents"
                          };
                case "Text" :
                    return {
                            TAG: 0,
                            _0: (function (param) {
                                return Json_decode.map((function (param) {
                                              return {
                                                      TAG: 1,
                                                      _0: param[0],
                                                      _1: param[1],
                                                      [Symbol.for("name")]: "Text"
                                                    };
                                            }), (function (param) {
                                              return Json_decode.pair(Json_decode.string, decode, param);
                                            }), param);
                              }),
                            [Symbol.for("name")]: "Contents"
                          };
                default:
                  throw {
                        RE_EXN_ID: Json_decode.DecodeError,
                        _1: "[RichText.Inline] Unknown constructor: " + x,
                        Error: new Error()
                      };
              }
            });
}

var decode$2 = decode$1(undefined);

function encode$1(x) {
  switch (x.TAG | 0) {
    case /* Icon */0 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Icon"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), encode, [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Text */1 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Text"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.pair((function (prim) {
                                return prim;
                              }), encode, [
                              x._0,
                              x._1
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Link */2 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Link"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        Json_encode.tuple3(Common$AgdaModeVscode.AgdaRange.encode, (function (param) {
                                return Json_encode.array(encode$1, param);
                              }), encode, [
                              x._0,
                              x._1,
                              x._2
                            ])
                      ],
                      tl: /* [] */0
                    }
                  });
    case /* Hole */3 :
        return Json_encode.object_({
                    hd: [
                      "tag",
                      "Hole"
                    ],
                    tl: {
                      hd: [
                        "contents",
                        x._0
                      ],
                      tl: /* [] */0
                    }
                  });
    
  }
}

var Inline = {
  decode: decode$2,
  encode: encode$1
};

var empty = {
  _0: [],
  [Symbol.for("name")]: "RichText"
};

function string(s) {
  return {
          _0: [{
              TAG: 1,
              _0: s,
              _1: [],
              [Symbol.for("name")]: "Text"
            }],
          [Symbol.for("name")]: "RichText"
        };
}

function hole(i) {
  return {
          _0: [{
              TAG: 3,
              _0: i,
              [Symbol.for("name")]: "Hole"
            }],
          [Symbol.for("name")]: "RichText"
        };
}

function srcLoc(range) {
  return {
          _0: [{
              TAG: 2,
              _0: range,
              _1: [
                {
                  TAG: 0,
                  _0: "link ",
                  _1: [],
                  [Symbol.for("name")]: "Icon"
                },
                {
                  TAG: 1,
                  _0: Common$AgdaModeVscode.AgdaRange.toString(range),
                  _1: [],
                  [Symbol.for("name")]: "Text"
                }
              ],
              _2: ["component-link component-hole"],
              [Symbol.for("name")]: "Link"
            }],
          [Symbol.for("name")]: "RichText"
        };
}

function concatMany(xs) {
  return {
          _0: Belt_Array.concatMany(Belt_Array.map(xs, (function (x) {
                      return x._0;
                    }))),
          [Symbol.for("name")]: "RichText"
        };
}

function parse(raw) {
  return concatMany(Belt_Array.mapWithIndex(Belt_Array.keepMap(raw.split(/([^\(\)\s]+\:(?:\d+\,\d+\-\d+\,\d+|\d+\,\d+\-\d+))/), (function (x) {
                        return x;
                      })), (function (i, token) {
                    var match = i % 2;
                    if (match !== 1) {
                      return string(token);
                    } else {
                      return Belt_Option.mapWithDefault(Curry._1(Common$AgdaModeVscode.AgdaRange.parse, token), string(token), srcLoc);
                    }
                  })));
}

function make(value) {
  return React.createElement("span", undefined, Belt_Array.mapWithIndex(value._0, (function (i, x) {
                    switch (x.TAG | 0) {
                      case /* Icon */0 :
                          var className = Belt_Array.concat([
                                "codicon",
                                "codicon-" + x._0
                              ], x._1);
                          var className$1 = $$String.concat(" ", Belt_List.fromArray(className));
                          return React.createElement("div", {
                                      key: String(i),
                                      className: className$1
                                    });
                      case /* Text */1 :
                          var className$2 = $$String.concat(" ", Belt_List.fromArray(x._1));
                          return React.createElement("span", {
                                      key: String(i),
                                      className: className$2
                                    }, x._0);
                      case /* Link */2 :
                          var className$3 = Belt_Array.concat([
                                "component-link",
                                "component-location"
                              ], x._2);
                          var child = make({
                                _0: x._1,
                                [Symbol.for("name")]: "RichText"
                              });
                          return React.createElement(Component__Link$AgdaModeVscode.make, {
                                      target: {
                                        TAG: 0,
                                        _0: x._0,
                                        [Symbol.for("name")]: "SrcLoc"
                                      },
                                      jump: true,
                                      hover: false,
                                      className: className$3,
                                      children: child,
                                      key: String(i)
                                    });
                      case /* Hole */3 :
                          var index = x._0;
                          var className$4 = [
                            "component-link",
                            "component-hole"
                          ];
                          return React.createElement(Component__Link$AgdaModeVscode.make, {
                                      target: {
                                        TAG: 1,
                                        _0: index,
                                        [Symbol.for("name")]: "Hole"
                                      },
                                      jump: true,
                                      hover: false,
                                      className: className$4,
                                      children: "?" + String(index),
                                      key: String(i)
                                    });
                      
                    }
                  })));
}

function decode$3(param) {
  return Json_decode.map((function (elems) {
                return {
                        _0: elems,
                        [Symbol.for("name")]: "RichText"
                      };
              }), (function (param) {
                return Json_decode.array(decode$2, param);
              }), param);
}

function encode$2(x) {
  return Json_encode.array(encode$1, x._0);
}

var Module = {
  ClassNames: ClassNames,
  Inline: Inline,
  empty: empty,
  string: string,
  hole: hole,
  srcLoc: srcLoc,
  concatMany: concatMany,
  parse: parse,
  make: make,
  decode: decode$3,
  encode: encode$2
};

function RichText(Props) {
  return make(Props.value);
}

var make$1 = RichText;

exports.Module = Module;
exports.ClassNames = ClassNames;
exports.Inline = Inline;
exports.empty = empty;
exports.string = string;
exports.hole = hole;
exports.srcLoc = srcLoc;
exports.concatMany = concatMany;
exports.parse = parse;
exports.decode = decode$3;
exports.encode = encode$2;
exports.make = make$1;
/* decode Not a pure module */
