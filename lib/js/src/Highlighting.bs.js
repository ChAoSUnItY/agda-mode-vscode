// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Belt_List = require("rescript/lib/js/belt_List.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Pervasives = require("rescript/lib/js/pervasives.js");
var Belt_Option = require("rescript/lib/js/belt_Option.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Util$AgdaModeVscode = require("./Util/Util.bs.js");
var Parser$AgdaModeVscode = require("./Parser/Parser.bs.js");

function toString(x) {
  switch (x) {
    case /* Namespace */0 :
        return "namespace";
    case /* Type */1 :
        return "type";
    case /* Class */2 :
        return "class";
    case /* Enum */3 :
        return "enum";
    case /* Interface */4 :
        return "interface";
    case /* Struct */5 :
        return "struct";
    case /* TypeParameter */6 :
        return "typeParameter";
    case /* Parameter */7 :
        return "parameter";
    case /* Variable */8 :
        return "variable";
    case /* Property */9 :
        return "property";
    case /* EnumMember */10 :
        return "enumMember";
    case /* Event */11 :
        return "event";
    case /* Function */12 :
        return "function";
    case /* Member */13 :
        return "member";
    case /* Macro */14 :
        return "macro";
    case /* Label */15 :
        return "label";
    case /* Comment */16 :
        return "comment";
    case /* String */17 :
        return "string";
    case /* Keyword */18 :
        return "keyword";
    case /* Number */19 :
        return "number";
    case /* Regexp */20 :
        return "regexp";
    case /* Operator */21 :
        return "operator";
    
  }
}

var enumurate = [
  "namespace",
  "type",
  "class",
  "enum",
  "interface",
  "struct",
  "typeParameter",
  "parameter",
  "variable",
  "property",
  "enumMember",
  "event",
  "function",
  "member",
  "macro",
  "label",
  "comment",
  "string",
  "keyword",
  "number",
  "regexp",
  "operator"
];

var TokenType = {
  toString: toString,
  enumurate: enumurate
};

function toString$1(x) {
  switch (x) {
    case /* Declaration */0 :
        return "declaration";
    case /* Readonly */1 :
        return "readonly";
    case /* Static */2 :
        return "static";
    case /* Deprecated */3 :
        return "deprecated";
    case /* Abstract */4 :
        return "abstract";
    case /* Async */5 :
        return "async";
    case /* Modification */6 :
        return "modification";
    case /* Documentation */7 :
        return "documentation";
    case /* DefaultLibrary */8 :
        return "defaultLibrary";
    
  }
}

var enumurate$1 = [
  "declaration",
  "readonly",
  "static",
  "deprecated",
  "abstract",
  "async",
  "modification",
  "documentation",
  "defaultLibrary"
];

var TokenModifier = {
  toString: toString$1,
  enumurate: enumurate$1
};

function toTokenTypeAndModifiers(x) {
  if (x >= 10) {
    return [
            /* Keyword */18,
            undefined
          ];
  }
  switch (x) {
    case /* Number */3 :
        return [
                /* Number */19,
                undefined
              ];
    case /* Keyword */1 :
    case /* String */2 :
    case /* Symbol */4 :
        return [
                /* Keyword */18,
                undefined
              ];
    case /* PrimitiveType */5 :
        return [
                /* Type */1,
                undefined
              ];
    case /* Pragma */6 :
        return [
                /* Macro */14,
                undefined
              ];
    case /* Comment */0 :
    case /* Background */7 :
        return [
                /* Comment */16,
                undefined
              ];
    case /* Markup */8 :
        return [
                /* Label */15,
                undefined
              ];
    case /* Error */9 :
        return [
                /* Keyword */18,
                [/* Deprecated */3]
              ];
    
  }
}

function parse(x) {
  switch (x) {
    case "argument" :
        return /* Argument */32;
    case "background" :
        return /* Background */7;
    case "bound" :
        return /* Bound */21;
    case "catchallclause" :
        return /* CatchallClause */19;
    case "coinductiveconstructor" :
        return /* ConstructorCoInductive */24;
    case "comment" :
        return /* Comment */0;
    case "confluenceproblem" :
        return /* ConfluenceProblem */20;
    case "coverageproblem" :
        return /* CoverageProblem */16;
    case "datatype" :
        return /* Datatype */25;
    case "deadcode" :
        return /* Deadcode */15;
    case "dottedpattern" :
        return /* DottedPattern */10;
    case "error" :
        return /* Error */9;
    case "field" :
        return /* Field */26;
    case "function" :
        return /* Function */27;
    case "generalizable" :
        return /* Generalizable */22;
    case "incompletepattern" :
        return /* IncompletePattern */17;
    case "inductiveconstructor" :
        return /* ConstructorInductive */23;
    case "keyword" :
        return /* Keyword */1;
    case "macro" :
        return /* Macro */33;
    case "markup" :
        return /* Markup */8;
    case "module" :
        return /* Module */28;
    case "number" :
        return /* Number */3;
    case "operator" :
        return /* Operator */34;
    case "positivityproblem" :
        return /* PositivityProblem */14;
    case "postulate" :
        return /* Postulate */29;
    case "pragma" :
        return /* Pragma */6;
    case "primitive" :
        return /* Primitive */30;
    case "primitivetype" :
        return /* PrimitiveType */5;
    case "record" :
        return /* Record */31;
    case "string" :
        return /* String */2;
    case "symbol" :
        return /* Symbol */4;
    case "terminationproblem" :
        return /* TerminationProblem */13;
    case "typechecks" :
        return /* TypeChecks */18;
    case "unsolvedconstraint" :
        return /* UnsolvedConstraint */12;
    case "unsolvedmeta" :
        return /* UnsolvedMeta */11;
    default:
      return /* Operator */34;
  }
}

function toStyle(x) {
  switch (x) {
    case /* Comment */0 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#B0B0B0",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#505050",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Keyword */1 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#CD6600",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#FF9932",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* String */2 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#B22222",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#DD4D4D",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Number */3 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#800080",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#9010E0",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Symbol */4 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#404040",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#BFBFBF",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Error */9 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#FF0000",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#FF0000",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* UnsolvedMeta */11 :
    case /* UnsolvedConstraint */12 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#FFFF00",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#806B00",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* TerminationProblem */13 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#FFA07A",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#802400",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* PositivityProblem */14 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#CD853F",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#803F00",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Deadcode */15 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#A9A9A9",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#808080",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* CoverageProblem */16 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#F5DEB3",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#805300",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* IncompletePattern */17 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#800080",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#800080",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* CatchallClause */19 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#F5F5F5",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#404040",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* ConfluenceProblem */20 :
        return {
                _0: {
                  TAG: 0,
                  _0: "#FFC0CB",
                  [Symbol.for("name")]: "Background"
                },
                _1: {
                  TAG: 0,
                  _0: "#800080",
                  [Symbol.for("name")]: "Background"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* ConstructorInductive */23 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#008B00",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#29CC29",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* ConstructorCoInductive */24 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#996600",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#FFEA75",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Field */26 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#EE1289",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#F570B7",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Module */28 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#800080",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#CD80FF",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* PrimitiveType */5 :
    case /* Datatype */25 :
    case /* Function */27 :
    case /* Postulate */29 :
    case /* Primitive */30 :
    case /* Record */31 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#0000CD",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#8080FF",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Macro */33 :
        return {
                _0: {
                  TAG: 1,
                  _0: "#458B74",
                  [Symbol.for("name")]: "Foreground"
                },
                _1: {
                  TAG: 1,
                  _0: "#73BAA2",
                  [Symbol.for("name")]: "Foreground"
                },
                [Symbol.for("name")]: "Themed"
              };
    case /* Pragma */6 :
    case /* Background */7 :
    case /* Markup */8 :
    case /* DottedPattern */10 :
    case /* TypeChecks */18 :
    case /* Bound */21 :
    case /* Generalizable */22 :
    case /* Argument */32 :
    case /* Operator */34 :
        return /* Noop */0;
    
  }
}

var Aspect = {
  TokenType: TokenType,
  TokenModifier: TokenModifier,
  toTokenTypeAndModifiers: toTokenTypeAndModifiers,
  parse: parse,
  toStyle: toStyle
};

function toString$2(self) {
  var match = self.source;
  return "Annotation " + (String(self.start) + (" " + (String(self.end_) + (" " + (Util$AgdaModeVscode.Pretty.list(Belt_List.fromArray(self.aspects)) + (
                    match !== undefined ? match[0] + (" " + String(match[1])) : ""
                  ))))));
}

function parse$1(x) {
  if (x.TAG === /* A */0) {
    return ;
  }
  var xs = x._0;
  var len = xs.length;
  if (len >= 7) {
    return ;
  }
  switch (len) {
    case 3 :
        var start$p = xs[0];
        if (start$p.TAG !== /* A */0) {
          return ;
        }
        var end_$p = xs[1];
        if (end_$p.TAG !== /* A */0) {
          return ;
        }
        var end_$p$1 = end_$p._0;
        var aspects = xs[2];
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$p._0), (function (start) {
                      return Belt_Option.map(Pervasives.int_of_string_opt(end_$p$1), (function (end_) {
                                    return {
                                            start: start - 1 | 0,
                                            end_: end_ - 1 | 0,
                                            aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects), parse),
                                            isTokenBased: false,
                                            note: undefined,
                                            source: undefined
                                          };
                                  }));
                    }));
    case 4 :
        var start$p$1 = xs[0];
        if (start$p$1.TAG !== /* A */0) {
          return ;
        }
        var end_$p$2 = xs[1];
        if (end_$p$2.TAG !== /* A */0) {
          return ;
        }
        var end_$p$3 = end_$p$2._0;
        var aspects$1 = xs[2];
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$p$1._0), (function (start) {
                      return Belt_Option.map(Pervasives.int_of_string_opt(end_$p$3), (function (end_) {
                                    return {
                                            start: start - 1 | 0,
                                            end_: end_ - 1 | 0,
                                            aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects$1), parse),
                                            isTokenBased: false,
                                            note: undefined,
                                            source: undefined
                                          };
                                  }));
                    }));
    case 0 :
    case 1 :
    case 2 :
    case 5 :
        return ;
    case 6 :
        var start$p$2 = xs[0];
        if (start$p$2.TAG !== /* A */0) {
          return ;
        }
        var end_$p$4 = xs[1];
        if (end_$p$4.TAG !== /* A */0) {
          return ;
        }
        var end_$p$5 = end_$p$4._0;
        var aspects$2 = xs[2];
        var match = xs[5];
        if (match.TAG === /* A */0) {
          return ;
        }
        var match$1 = match._0;
        if (match$1.length !== 3) {
          return ;
        }
        var filepath = match$1[0];
        if (filepath.TAG !== /* A */0) {
          return ;
        }
        var filepath$1 = filepath._0;
        var index$p = match$1[2];
        if (index$p.TAG !== /* A */0) {
          return ;
        }
        var index$p$1 = index$p._0;
        return Belt_Option.flatMap(Pervasives.int_of_string_opt(start$p$2._0), (function (start) {
                      return Belt_Option.flatMap(Pervasives.int_of_string_opt(end_$p$5), (function (end_) {
                                    return Belt_Option.map(Pervasives.int_of_string_opt(index$p$1), (function (index) {
                                                  return {
                                                          start: start - 1 | 0,
                                                          end_: end_ - 1 | 0,
                                                          aspects: Belt_Array.map(Parser$AgdaModeVscode.SExpression.flatten(aspects$2), parse),
                                                          isTokenBased: false,
                                                          note: undefined,
                                                          source: [
                                                            filepath$1,
                                                            index
                                                          ]
                                                        };
                                                }));
                                  }));
                    }));
    
  }
}

function parseDirectHighlightings(tokens) {
  return Belt_Array.keepMap(Belt_Array.map(tokens.slice(2), parse$1), (function (x) {
                return x;
              }));
}

function decode(param) {
  return Json_decode.map((function (param) {
                return {
                        start: param[0] - 1 | 0,
                        end_: param[1] - 1 | 0,
                        aspects: Belt_Array.map(param[2], parse),
                        isTokenBased: param[3],
                        note: param[4],
                        source: param[5]
                      };
              }), (function (param) {
                return Util$AgdaModeVscode.Decode.tuple6(Json_decode.$$int, Json_decode.$$int, (function (param) {
                              return Json_decode.array(Json_decode.string, param);
                            }), Json_decode.bool, (function (param) {
                              return Json_decode.optional(Json_decode.string, param);
                            }), (function (param) {
                              return Json_decode.optional((function (param) {
                                            return Json_decode.pair(Json_decode.string, Json_decode.$$int, param);
                                          }), param);
                            }), param);
              }), param);
}

function decode$1(param) {
  return Json_decode.map((function (param) {
                return {
                        _0: param[0],
                        _1: param[1],
                        [Symbol.for("name")]: "Infos"
                      };
              }), (function (param) {
                return Json_decode.pair(Json_decode.bool, (function (param) {
                              return Json_decode.array(decode, param);
                            }), param);
              }), param);
}

function toInfos(x) {
  return x._1;
}

var Infos = {
  decode: decode$1,
  toInfos: toInfos
};

var Token;

exports.Aspect = Aspect;
exports.Token = Token;
exports.toString = toString$2;
exports.parse = parse$1;
exports.parseDirectHighlightings = parseDirectHighlightings;
exports.decode = decode;
exports.Infos = Infos;
/* Util-AgdaModeVscode Not a pure module */
