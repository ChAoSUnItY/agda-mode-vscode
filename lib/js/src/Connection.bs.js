// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Net = require("net");
var Json = require("@glennsl/bs-json/lib/js/src/Json.bs.js");
var Curry = require("bs-platform/lib/js/curry.js");
var VSCode = require("bs-vscode/lib/js/src/VSCode.bs.js");
var Vscode = require("vscode");
var $$Promise = require("reason-promise/lib/js/src/js/promise.bs.js");
var Untildify = require("untildify");
var Belt_Array = require("bs-platform/lib/js/belt_Array.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Json_encode = require("@glennsl/bs-json/lib/js/src/Json_encode.bs.js");
var Caml_primitive = require("bs-platform/lib/js/caml_primitive.js");
var Caml_js_exceptions = require("bs-platform/lib/js/caml_js_exceptions.js");
var LSP$AgdaModeVscode = require("./LSP.bs.js");
var Chan$AgdaModeVscode = require("./Util/Chan.bs.js");
var Util$AgdaModeVscode = require("./Util/Util.bs.js");
var Common$AgdaModeVscode = require("./Common.bs.js");
var Config$AgdaModeVscode = require("./Config.bs.js");
var Parser$AgdaModeVscode = require("./Parser.bs.js");
var VscodeLanguageclient = require("vscode-languageclient");
var Process$AgdaModeVscode = require("./Process.bs.js");
var Response$AgdaModeVscode = require("./Response.bs.js");
var RichText$AgdaModeVscode = require("./View/RichText.bs.js");
var Highlighting$AgdaModeVscode = require("./Highlighting.bs.js");

function toString(x) {
  if (x.TAG === /* CannotDecodeJSON */0) {
    return "Cannot decode JSON: \n" + x._0;
  } else {
    return "Cannot read IOTCM: \n" + x._0;
  }
}

var decode = Util$AgdaModeVscode.Decode.sum(function (x) {
      switch (x) {
        case "CmdErrCannotDecodeJSON" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (version) {
                                      return {
                                              TAG: 0,
                                              _0: version,
                                              [Symbol.for("name")]: "CannotDecodeJSON"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "CmdErrCannotParseCommand" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (version) {
                                      return {
                                              TAG: 1,
                                              _0: version,
                                              [Symbol.for("name")]: "CannotParseCommand"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[LSP.CommandErr] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var CommandErr = {
  toString: toString,
  decode: decode
};

function toString$1(error) {
  if (typeof error === "number") {
    return [
            "[LSP] Cannot Initialize Connection",
            ""
          ];
  }
  switch (error.TAG | 0) {
    case /* Connection */0 :
        var exn = error._0;
        var isECONNREFUSED = Belt_Option.mapWithDefault(exn.message, false, (function (param) {
                return param.startsWith("connect ECONNREFUSED");
              }));
        if (isECONNREFUSED) {
          return [
                  "[LSP] Connection Error",
                  "Please enter \":main -d\" in ghci"
                ];
        } else {
          return [
                  "[LSP] Client Internal Connection Error",
                  Belt_Option.getWithDefault(exn.message, "")
                ];
        }
    case /* SendCommand */1 :
        return [
                "[LSP] Cannot Send Command",
                toString(error._0)
              ];
    case /* CannotDecodeCommandRes */2 :
        return [
                "[LSP] Cannot Send Command",
                "Cannot decode the result after sending command" + error._0 + "\n" + Json.stringify(error._1)
              ];
    case /* CannotDecodeResponse */3 :
        return [
                "[LSP] Cannot Parse Response",
                "Cannot decode responses from the server" + error._0 + "\n" + Json.stringify(error._1)
              ];
    
  }
}

var LSP = {
  CommandErr: CommandErr,
  toString: toString$1
};

function toString$2(x) {
  if (typeof x === "number") {
    return [
            "Connection not established yet",
            ""
          ];
  }
  switch (x.TAG | 0) {
    case /* CannotConnectViaStdIO */0 :
        var match = Curry._1(Process$AgdaModeVscode.PathSearch.$$Error.toString, x._0);
        return [
                "Cannot locate \"als\"",
                match[1] + "\nPlease make sure that the executable is in the path"
              ];
    case /* CannotConnectViaTCP */1 :
        return [
                "Cannot connect with the server",
                "Please enter \":main -d\" in ghci"
              ];
    case /* PathSearch */2 :
        return Curry._1(Process$AgdaModeVscode.PathSearch.$$Error.toString, x._0);
    case /* Validation */3 :
        return Curry._1(Process$AgdaModeVscode.Validation.$$Error.toString, x._0);
    case /* Process */4 :
        return Process$AgdaModeVscode.$$Error.toString(x._0);
    case /* LSP */5 :
        return toString$1(x._0);
    case /* ResponseParseError */6 :
        return [
                "Internal Parse Error",
                Parser$AgdaModeVscode.$$Error.toString(x._0)
              ];
    
  }
}

var $$Error = {
  LSP: LSP,
  toString: toString$2
};

function make(param) {
  return {
          tally: 0,
          allDone: Chan$AgdaModeVscode.make(undefined),
          deferredLastResponses: []
        };
}

function runNonLast(self, handler, response) {
  self.tally = self.tally + 1 | 0;
  return $$Promise.get(Curry._1(handler, {
                  TAG: 0,
                  _0: response,
                  [Symbol.for("name")]: "Ok"
                }), (function (param) {
                self.tally = self.tally - 1 | 0;
                if (self.tally === 0) {
                  return Chan$AgdaModeVscode.emit(self.allDone, undefined);
                }
                
              }));
}

function addLast(self, priority, response) {
  self.deferredLastResponses.push([
        priority,
        response
      ]);
  
}

function onceDone(self) {
  if (self.tally === 0) {
    return $$Promise.resolved(undefined);
  } else {
    return Chan$AgdaModeVscode.once(self.allDone);
  }
}

function runLast(self, handler) {
  return $$Promise.get(onceDone(self), (function (param) {
                var deferredLastResponses = Belt_Array.map(self.deferredLastResponses.sort(function (x, y) {
                          return Caml_primitive.caml_int_compare(x[0], y[0]);
                        }), (function (prim) {
                        return prim[1];
                      }));
                deferredLastResponses.unshift(/* CompleteHighlightingAndMakePromptReappear */4);
                Util$AgdaModeVscode.oneByOne(Belt_Array.map(deferredLastResponses, (function (res) {
                            return Curry._1(handler, {
                                        TAG: 0,
                                        _0: res,
                                        [Symbol.for("name")]: "Ok"
                                      });
                          })));
                
              }));
}

var Scheduler = {
  make: make,
  runNonLast: runNonLast,
  addLast: addLast,
  runLast: runLast
};

function destroy(self) {
  Chan$AgdaModeVscode.destroy(self.chan);
  self.encountedFirstPrompt = false;
  return Process$AgdaModeVscode.destroy(self.process);
}

function wire(self) {
  var toResponse = Curry._1(Parser$AgdaModeVscode.Incr.Gen.flatMap, (function (x) {
          if (x.TAG !== /* Ok */0) {
            return {
                    _0: {
                      TAG: 1,
                      _0: x._0,
                      [Symbol.for("name")]: "Error"
                    },
                    [Symbol.for("name")]: "Yield"
                  };
          }
          var tokens = x._0;
          if (tokens.TAG === /* A */0 && tokens._0 === "Agda2>") {
            return /* Stop */0;
          } else {
            return {
                    _0: Response$AgdaModeVscode.Prioritized.parse(tokens),
                    [Symbol.for("name")]: "Yield"
                  };
          }
        }));
  var mapError = function (x) {
    return Curry._2(Parser$AgdaModeVscode.Incr.Gen.map, (function (x) {
                  if (x.TAG === /* Ok */0) {
                    return {
                            TAG: 0,
                            _0: x._0,
                            [Symbol.for("name")]: "Ok"
                          };
                  }
                  var match = x._0;
                  return {
                          TAG: 1,
                          _0: {
                            TAG: 0,
                            _0: match[0],
                            _1: match[1],
                            [Symbol.for("name")]: "SExpression"
                          },
                          [Symbol.for("name")]: "Error"
                        };
                }), x);
  };
  var pipeline = Parser$AgdaModeVscode.SExpression.makeIncr(function (x) {
        var res = Curry._1(toResponse, mapError(x));
        if (res) {
          return Chan$AgdaModeVscode.emit(self.chan, {
                      TAG: 0,
                      _0: {
                        _0: res._0,
                        [Symbol.for("name")]: "Yield"
                      },
                      [Symbol.for("name")]: "Ok"
                    });
        } else if (self.encountedFirstPrompt) {
          return Chan$AgdaModeVscode.emit(self.chan, {
                      TAG: 0,
                      _0: /* Stop */0,
                      [Symbol.for("name")]: "Ok"
                    });
        } else {
          self.encountedFirstPrompt = true;
          return ;
        }
      });
  Process$AgdaModeVscode.onOutput(self.process, (function (x) {
          switch (x.TAG | 0) {
            case /* Stdout */0 :
                return Belt_Array.forEach(Parser$AgdaModeVscode.split(x._0), (function (param) {
                              return Parser$AgdaModeVscode.Incr.feed(pipeline, param);
                            }));
            case /* Stderr */1 :
                return ;
            case /* Error */2 :
                return Chan$AgdaModeVscode.emit(self.chan, {
                            TAG: 1,
                            _0: {
                              TAG: 4,
                              _0: x._0,
                              [Symbol.for("name")]: "Process"
                            },
                            [Symbol.for("name")]: "Error"
                          });
            
          }
        }));
  
}

function make$1(param) {
  var getPath = function (param) {
    var storedPath = Config$AgdaModeVscode.getAgdaPath(undefined);
    if (!(storedPath === "" || storedPath === ".")) {
      return $$Promise.resolved({
                  TAG: 0,
                  _0: storedPath,
                  [Symbol.for("name")]: "Ok"
                });
    }
    var agdaVersion = Config$AgdaModeVscode.getAgdaVersion(undefined);
    return $$Promise.mapError($$Promise.mapOk(Process$AgdaModeVscode.PathSearch.run(agdaVersion), (function (prim) {
                      return prim.trim();
                    })), (function (e) {
                  return {
                          TAG: 2,
                          _0: e,
                          [Symbol.for("name")]: "PathSearch"
                        };
                }));
  };
  var setPath = function (metadata) {
    return $$Promise.map(Config$AgdaModeVscode.setAgdaPath(metadata.path), (function (param) {
                  return {
                          TAG: 0,
                          _0: metadata,
                          [Symbol.for("name")]: "Ok"
                        };
                }));
  };
  var args = ["--interaction"];
  return $$Promise.tapOk($$Promise.mapOk($$Promise.flatMapOk($$Promise.flatMapOk(getPath(undefined), (function (path) {
                            var validator = function (output) {
                              var match_ = output.match(/Agda version (.*)/);
                              if (match_ === null) {
                                return {
                                        TAG: 1,
                                        _0: "Cannot read Agda version",
                                        [Symbol.for("name")]: "Error"
                                      };
                              }
                              var version = Belt_Array.get(match_, 1);
                              if (version !== undefined) {
                                return {
                                        TAG: 0,
                                        _0: version,
                                        [Symbol.for("name")]: "Ok"
                                      };
                              } else {
                                return {
                                        TAG: 1,
                                        _0: "Cannot read Agda version",
                                        [Symbol.for("name")]: "Error"
                                      };
                              }
                            };
                            var path$1 = Untildify(path);
                            return $$Promise.mapError($$Promise.mapOk(Process$AgdaModeVscode.Validation.run("\"" + (path$1 + "\" -V"), validator), (function (version) {
                                              return {
                                                      path: path$1,
                                                      args: args,
                                                      version: version
                                                    };
                                            })), (function (e) {
                                          return {
                                                  TAG: 3,
                                                  _0: e,
                                                  [Symbol.for("name")]: "Validation"
                                                };
                                        }));
                          })), setPath), (function (metadata) {
                    return {
                            metadata: metadata,
                            process: Process$AgdaModeVscode.make(metadata.path, metadata.args),
                            chan: Chan$AgdaModeVscode.make(undefined),
                            encountedFirstPrompt: false
                          };
                  })), wire);
}

function sendRequest(connection, encoded) {
  Process$AgdaModeVscode.send(connection.process, encoded);
  
}

function onResponse(connection, callback) {
  var scheduler = make(undefined);
  var match = $$Promise.pending(undefined);
  var stopListener = match[1];
  var listener = function (x) {
    if (x.TAG === /* Ok */0) {
      var match = x._0;
      if (match) {
        var error = match._0;
        if (error.TAG === /* Ok */0) {
          var response = error._0;
          if (response.TAG === /* NonLast */0) {
            return runNonLast(scheduler, callback, response._0);
          } else {
            return addLast(scheduler, response._0, response._1);
          }
        }
        Curry._1(callback, {
              TAG: 1,
              _0: {
                TAG: 6,
                _0: error._0,
                [Symbol.for("name")]: "ResponseParseError"
              },
              [Symbol.for("name")]: "Error"
            });
        return ;
      }
      Curry._1(stopListener, undefined);
      return runLast(scheduler, callback);
    }
    Curry._1(callback, {
          TAG: 1,
          _0: x._0,
          [Symbol.for("name")]: "Error"
        });
    
  };
  var listenerHandle = {
    contents: undefined
  };
  listenerHandle.contents = Chan$AgdaModeVscode.on(connection.chan, listener);
  return $$Promise.tap(match[0], (function (param) {
                return Belt_Option.forEach(listenerHandle.contents, (function (destroyListener) {
                              return Curry._1(destroyListener, undefined);
                            }));
              }));
}

function getVersion(conn) {
  return conn.metadata.version;
}

var Emacs = {
  make: make$1,
  destroy: destroy,
  onResponse: onResponse,
  sendRequest: sendRequest,
  getVersion: getVersion
};

function encode(x) {
  if (x) {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "CmdReq"
                ],
                tl: {
                  hd: [
                    "contents",
                    x._0
                  ],
                  tl: /* [] */0
                }
              });
  } else {
    return Json_encode.object_({
                hd: [
                  "tag",
                  "CmdReqSYN"
                ],
                tl: /* [] */0
              });
  }
}

var CommandReq = {
  encode: encode
};

function fromJsError(error) {
  return (function (e) {return e.toString()})(error);
}

var decode$1 = Util$AgdaModeVscode.Decode.sum(function (x) {
      switch (x) {
        case "CmdRes" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (error) {
                                      return {
                                              TAG: 1,
                                              _0: error,
                                              [Symbol.for("name")]: "Result"
                                            };
                                    }), (function (param) {
                                      return Json_decode.optional(decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "CmdResACK" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (version) {
                                      return {
                                              TAG: 0,
                                              _0: version,
                                              [Symbol.for("name")]: "ACK"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[LSP.CommandRes] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var CommandRes = {
  fromJsError: fromJsError,
  decode: decode$1
};

var decode$2 = Util$AgdaModeVscode.Decode.sum(function (x) {
      switch (x) {
        case "DisplayInfoAllGoalsWarnings" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 2,
                                              _0: param[0],
                                              _1: param[1],
                                              _2: param[2],
                                              _3: param[3],
                                              _4: param[4],
                                              [Symbol.for("name")]: "AllGoalsWarnings"
                                            };
                                    }), (function (param) {
                                      return Util$AgdaModeVscode.Decode.tuple5(Json_decode.string, (function (param) {
                                                    return Json_decode.array((function (param) {
                                                                  return Json_decode.pair(RichText$AgdaModeVscode.decode, Json_decode.string, param);
                                                                }), param);
                                                  }), (function (param) {
                                                    return Json_decode.array((function (param) {
                                                                  return Json_decode.tuple3(RichText$AgdaModeVscode.decode, Json_decode.string, Common$AgdaModeVscode.AgdaRange.decode, param);
                                                                }), param);
                                                  }), (function (param) {
                                                    return Json_decode.array(Json_decode.string, param);
                                                  }), (function (param) {
                                                    return Json_decode.array(Json_decode.string, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoAuto" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (body) {
                                      return {
                                              TAG: 3,
                                              _0: body,
                                              [Symbol.for("name")]: "Auto"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoCompilationOk" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "CompilationOk"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair((function (param) {
                                                    return Json_decode.array(Json_decode.string, param);
                                                  }), (function (param) {
                                                    return Json_decode.array(Json_decode.string, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoError" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (body) {
                                      return {
                                              TAG: 4,
                                              _0: body,
                                              [Symbol.for("name")]: "Error'"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoGeneric" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: param[0],
                                              _1: param[1],
                                              [Symbol.for("name")]: "Generic"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.string, Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoNormalForm" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (body) {
                                      return {
                                              TAG: 6,
                                              _0: body,
                                              [Symbol.for("name")]: "NormalForm"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "DisplayInfoTime" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (body) {
                                      return {
                                              TAG: 5,
                                              _0: body,
                                              [Symbol.for("name")]: "Time"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[LSP.DisplayInfo] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var DisplayInfo = {
  decode: decode$2
};

function toString$3(x) {
  if (typeof x === "number") {
    return "========";
  }
  switch (x.TAG | 0) {
    case /* ResponseNonLast */0 :
        return Response$AgdaModeVscode.toString(x._0);
    case /* ResponseLast */1 :
        return "[Last " + String(x._0) + "] " + Response$AgdaModeVscode.toString(x._1);
    case /* ResponseParseError */2 :
        return Parser$AgdaModeVscode.$$Error.toString(x._0);
    
  }
}

var decode$3 = Util$AgdaModeVscode.Decode.sum(function (x) {
      switch (x) {
        case "ResponseClearHighlightingNotOnlyTokenBased" :
        case "ResponseClearHighlightingTokenBased" :
            return {
                    TAG: 1,
                    _0: {
                      TAG: 0,
                      _0: /* ClearHighlighting */1,
                      [Symbol.for("name")]: "ResponseNonLast"
                    },
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ResponseClearRunningInfo" :
            return {
                    TAG: 1,
                    _0: {
                      TAG: 0,
                      _0: /* ClearRunningInfo */0,
                      [Symbol.for("name")]: "ResponseNonLast"
                    },
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ResponseDisplayInfo" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (info) {
                                      switch (info.TAG | 0) {
                                        case /* Generic */0 :
                                            var header = info._0;
                                            switch (header) {
                                              case "*Agda Version*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 18,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "Version"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Constraints*" :
                                                  var body = info._1;
                                                  if (body === "nil") {
                                                    return {
                                                            TAG: 0,
                                                            _0: {
                                                              TAG: 9,
                                                              _0: {
                                                                TAG: 2,
                                                                _0: undefined,
                                                                [Symbol.for("name")]: "Constraints"
                                                              },
                                                              [Symbol.for("name")]: "DisplayInfo"
                                                            },
                                                            [Symbol.for("name")]: "ResponseNonLast"
                                                          };
                                                  } else {
                                                    return {
                                                            TAG: 0,
                                                            _0: {
                                                              TAG: 9,
                                                              _0: {
                                                                TAG: 2,
                                                                _0: body,
                                                                [Symbol.for("name")]: "Constraints"
                                                              },
                                                              [Symbol.for("name")]: "DisplayInfo"
                                                            },
                                                            [Symbol.for("name")]: "ResponseNonLast"
                                                          };
                                                  }
                                              case "*Context*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 16,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "Context"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Current Goal*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 14,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "CurrentGoal"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Goal type etc.*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 13,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "GoalType"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Helper function*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 17,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "HelperFunction"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Inferred Type*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 15,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "InferredType"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Intro*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 7,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "Intro"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Module contents*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 9,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "ModuleContents"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Scope Info*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 11,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "WhyInScope"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              case "*Search About*" :
                                                  return {
                                                          TAG: 0,
                                                          _0: {
                                                            TAG: 9,
                                                            _0: {
                                                              TAG: 10,
                                                              _0: info._1,
                                                              [Symbol.for("name")]: "SearchAbout"
                                                            },
                                                            [Symbol.for("name")]: "DisplayInfo"
                                                          },
                                                          [Symbol.for("name")]: "ResponseNonLast"
                                                        };
                                              default:
                                                return {
                                                        TAG: 0,
                                                        _0: {
                                                          TAG: 9,
                                                          _0: {
                                                            TAG: 3,
                                                            _0: header,
                                                            _1: info._1,
                                                            [Symbol.for("name")]: "AllGoalsWarnings"
                                                          },
                                                          [Symbol.for("name")]: "DisplayInfo"
                                                        },
                                                        [Symbol.for("name")]: "ResponseNonLast"
                                                      };
                                            }
                                        case /* CompilationOk */1 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 1,
                                                        _0: info._0,
                                                        _1: info._1,
                                                        [Symbol.for("name")]: "CompilationOkLSP"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        case /* AllGoalsWarnings */2 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 4,
                                                        _0: info._0,
                                                        _1: info._1,
                                                        _2: info._2,
                                                        _3: info._3,
                                                        _4: info._4,
                                                        [Symbol.for("name")]: "AllGoalsWarningsLSP"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        case /* Auto */3 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 8,
                                                        _0: info._0,
                                                        [Symbol.for("name")]: "Auto"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        case /* Error' */4 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 6,
                                                        _0: info._0,
                                                        [Symbol.for("name")]: "Error"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        case /* Time */5 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 5,
                                                        _0: info._0,
                                                        [Symbol.for("name")]: "Time"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        case /* NormalForm */6 :
                                            return {
                                                    TAG: 0,
                                                    _0: {
                                                      TAG: 9,
                                                      _0: {
                                                        TAG: 12,
                                                        _0: info._0,
                                                        [Symbol.for("name")]: "NormalForm"
                                                      },
                                                      [Symbol.for("name")]: "DisplayInfo"
                                                    },
                                                    [Symbol.for("name")]: "ResponseNonLast"
                                                  };
                                        
                                      }
                                    }), decode$2, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseDoneAborting" :
            return {
                    TAG: 1,
                    _0: {
                      TAG: 0,
                      _0: /* DoneAborting */2,
                      [Symbol.for("name")]: "ResponseNonLast"
                    },
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ResponseDoneExiting" :
            return {
                    TAG: 1,
                    _0: {
                      TAG: 0,
                      _0: /* DoneExiting */3,
                      [Symbol.for("name")]: "ResponseNonLast"
                    },
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ResponseEnd" :
            return {
                    TAG: 1,
                    _0: /* ResponseEnd */0,
                    [Symbol.for("name")]: "TagOnly"
                  };
        case "ResponseGiveAction" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: {
                                                TAG: 6,
                                                _0: param[0],
                                                _1: param[1],
                                                [Symbol.for("name")]: "GiveAction"
                                              },
                                              [Symbol.for("name")]: "ResponseNonLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.$$int, Response$AgdaModeVscode.GiveAction.decode, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseHighlightingInfoDirect" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: {
                                                TAG: 0,
                                                _0: param._0,
                                                _1: param._1,
                                                [Symbol.for("name")]: "HighlightingInfoDirect"
                                              },
                                              [Symbol.for("name")]: "ResponseNonLast"
                                            };
                                    }), Highlighting$AgdaModeVscode.Infos.decode, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseHighlightingInfoIndirect" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (filePath) {
                                      return {
                                              TAG: 0,
                                              _0: {
                                                TAG: 2,
                                                _0: filePath,
                                                [Symbol.for("name")]: "HighlightingInfoIndirectJSON"
                                              },
                                              [Symbol.for("name")]: "ResponseNonLast"
                                            };
                                    }), Json_decode.string, param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseInteractionPoints" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (ids) {
                                      return {
                                              TAG: 1,
                                              _0: 1,
                                              _1: {
                                                TAG: 5,
                                                _0: ids,
                                                [Symbol.for("name")]: "InteractionPoints"
                                              },
                                              [Symbol.for("name")]: "ResponseLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.array(Json_decode.$$int, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseJumpToError" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 1,
                                              _0: 3,
                                              _1: {
                                                TAG: 4,
                                                _0: param[0],
                                                _1: param[1],
                                                [Symbol.for("name")]: "JumpToError"
                                              },
                                              [Symbol.for("name")]: "ResponseLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.string, Json_decode.$$int, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseMakeCaseExtendedLambda" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (payload) {
                                      return {
                                              TAG: 1,
                                              _0: 2,
                                              _1: {
                                                TAG: 7,
                                                _0: /* ExtendedLambda */1,
                                                _1: payload,
                                                [Symbol.for("name")]: "MakeCase"
                                              },
                                              [Symbol.for("name")]: "ResponseLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.array(Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseMakeCaseFunction" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (payload) {
                                      return {
                                              TAG: 1,
                                              _0: 2,
                                              _1: {
                                                TAG: 7,
                                                _0: /* Function */0,
                                                _1: payload,
                                                [Symbol.for("name")]: "MakeCase"
                                              },
                                              [Symbol.for("name")]: "ResponseLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.array(Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseRunningInfo" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: {
                                                TAG: 10,
                                                _0: param[0],
                                                _1: param[1],
                                                [Symbol.for("name")]: "RunningInfo"
                                              },
                                              [Symbol.for("name")]: "ResponseNonLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.$$int, Json_decode.string, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseSolveAll" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (payloads) {
                                      return {
                                              TAG: 1,
                                              _0: 2,
                                              _1: {
                                                TAG: 8,
                                                _0: payloads,
                                                [Symbol.for("name")]: "SolveAll"
                                              },
                                              [Symbol.for("name")]: "ResponseLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.array((function (param) {
                                                    return Json_decode.pair(Json_decode.$$int, Json_decode.string, param);
                                                  }), param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        case "ResponseStatus" :
            return {
                    TAG: 0,
                    _0: (function (param) {
                        return Json_decode.map((function (param) {
                                      return {
                                              TAG: 0,
                                              _0: {
                                                TAG: 3,
                                                _0: param[0],
                                                _1: param[1],
                                                [Symbol.for("name")]: "Status"
                                              },
                                              [Symbol.for("name")]: "ResponseNonLast"
                                            };
                                    }), (function (param) {
                                      return Json_decode.pair(Json_decode.bool, Json_decode.bool, param);
                                    }), param);
                      }),
                    [Symbol.for("name")]: "Contents"
                  };
        default:
          throw {
                RE_EXN_ID: Json_decode.DecodeError,
                _1: "[LSP.Response] Unknown constructor: " + x,
                Error: new Error()
              };
      }
    });

var LSPResponse = {
  DisplayInfo: DisplayInfo,
  toString: toString$3,
  decode: decode$3
};

var errorChan = Chan$AgdaModeVscode.make(undefined);

var dataChan = Chan$AgdaModeVscode.make(undefined);

function onError(callback) {
  return new Vscode.Disposable(Chan$AgdaModeVscode.on(errorChan, (function (e) {
                    return Curry._1(callback, {
                                TAG: 5,
                                _0: {
                                  TAG: 0,
                                  _0: e,
                                  [Symbol.for("name")]: "Connection"
                                },
                                [Symbol.for("name")]: "LSP"
                              });
                  })));
}

function sendRequest$1(self, data) {
  return $$Promise.mapError($$Promise.flatMapOk($$Promise.Js.toResult(self.client.onReady()), (function (param) {
                    return $$Promise.Js.toResult(self.client.sendRequest("agda", data));
                  })), (function (exn) {
                return {
                        TAG: 5,
                        _0: {
                          TAG: 0,
                          _0: exn,
                          [Symbol.for("name")]: "Connection"
                        },
                        [Symbol.for("name")]: "LSP"
                      };
              }));
}

function make$2(method) {
  var serverOptions;
  serverOptions = method.TAG === /* ViaStdIO */0 ? LSP$AgdaModeVscode.ServerOptions.makeWithCommand(method._0) : LSP$AgdaModeVscode.ServerOptions.makeWithStreamInfo(method._0);
  var documentSelector = [VSCode.StringOr.others({
          language: "agda",
          pattern: undefined,
          scheme: "file"
        })];
  var synchronize = Vscode.workspace.createFileSystemWatcher('**/.clientrc', false, false, false);
  var errorHandler = LSP$AgdaModeVscode.ErrorHandler.make((function (exn, _msg, _count) {
          Chan$AgdaModeVscode.emit(errorChan, exn);
          return /* Shutdown */1;
        }), (function (param) {
          return /* DoNotRestart */0;
        }));
  var clientOptions = LSP$AgdaModeVscode.LanguageClientOptions.make(documentSelector, synchronize, errorHandler);
  var languageClient = new VscodeLanguageclient.LanguageClient("agdaLanguageServer", "Agda Language Server", serverOptions, clientOptions);
  var self_subscription = languageClient.start();
  var self = {
    client: languageClient,
    subscription: self_subscription,
    method: method
  };
  return $$Promise.map($$Promise.race({
                  hd: $$Promise.Js.toResult(languageClient.onReady()),
                  tl: {
                    hd: $$Promise.map(Chan$AgdaModeVscode.once(errorChan), (function (err) {
                            return {
                                    TAG: 1,
                                    _0: err,
                                    [Symbol.for("name")]: "Error"
                                  };
                          })),
                    tl: /* [] */0
                  }
                }), (function (result) {
                if (result.TAG !== /* Ok */0) {
                  return {
                          TAG: 1,
                          _0: {
                            TAG: 5,
                            _0: {
                              TAG: 0,
                              _0: result._0,
                              [Symbol.for("name")]: "Connection"
                            },
                            [Symbol.for("name")]: "LSP"
                          },
                          [Symbol.for("name")]: "Error"
                        };
                }
                languageClient.onRequest("agda", (function (json) {
                        Chan$AgdaModeVscode.emit(dataChan, json);
                        return $$Promise.resolved(undefined);
                      }));
                return {
                        TAG: 0,
                        _0: self,
                        [Symbol.for("name")]: "Ok"
                      };
              }));
}

var singleton = {
  contents: /* Disconnected */0
};

function stop(param) {
  var match = singleton.contents;
  if (match) {
    singleton.contents = /* Disconnected */0;
    var self = match._0;
    self.subscription.dispose();
    return $$Promise.map($$Promise.Js.toResult(self.client.stop()), (function (param) {
                  
                }));
  } else {
    return $$Promise.resolved(undefined);
  }
}

function decodeCommandRes(json) {
  var response;
  try {
    response = Curry._1(decode$1, json);
  }
  catch (raw_msg){
    var msg = Caml_js_exceptions.internalToOCamlException(raw_msg);
    if (msg.RE_EXN_ID === Json_decode.DecodeError) {
      return {
              TAG: 1,
              _0: {
                TAG: 5,
                _0: {
                  TAG: 2,
                  _0: msg._1,
                  _1: json,
                  [Symbol.for("name")]: "CannotDecodeCommandRes"
                },
                [Symbol.for("name")]: "LSP"
              },
              [Symbol.for("name")]: "Error"
            };
    }
    throw msg;
  }
  return {
          TAG: 0,
          _0: response,
          [Symbol.for("name")]: "Ok"
        };
}

function decodeResponse(json) {
  var reaction;
  try {
    reaction = Curry._1(decode$3, json);
  }
  catch (raw_msg){
    var msg = Caml_js_exceptions.internalToOCamlException(raw_msg);
    if (msg.RE_EXN_ID === Json_decode.DecodeError) {
      return {
              TAG: 1,
              _0: {
                TAG: 5,
                _0: {
                  TAG: 3,
                  _0: msg._1,
                  _1: json,
                  [Symbol.for("name")]: "CannotDecodeResponse"
                },
                [Symbol.for("name")]: "LSP"
              },
              [Symbol.for("name")]: "Error"
            };
    }
    throw msg;
  }
  return {
          TAG: 0,
          _0: reaction,
          [Symbol.for("name")]: "Ok"
        };
}

function sendRequestPrim(client, request) {
  return $$Promise.flatMapOk(sendRequest$1(client, encode(request)), (function (json) {
                return $$Promise.resolved(decodeCommandRes(json));
              }));
}

function probe(tryTCP, port, name) {
  var probeStdIO = function (name) {
    return $$Promise.mapError($$Promise.mapOk(Process$AgdaModeVscode.PathSearch.run(name), (function (path) {
                      return {
                              TAG: 0,
                              _0: name,
                              _1: path.trim(),
                              [Symbol.for("name")]: "ViaStdIO"
                            };
                    })), (function (e) {
                  return {
                          TAG: 0,
                          _0: e,
                          [Symbol.for("name")]: "CannotConnectViaStdIO"
                        };
                }));
  };
  var probeTCP = function (port) {
    var match = $$Promise.pending(undefined);
    var resolve = match[1];
    var socket = Net.connect(port, (function (param) {
            return Curry._1(resolve, {
                        TAG: 0,
                        _0: undefined,
                        [Symbol.for("name")]: "Ok"
                      });
          }));
    socket.on("error", (function (exn) {
            return Curry._1(resolve, {
                        TAG: 1,
                        _0: exn,
                        [Symbol.for("name")]: "Error"
                      });
          }));
    return $$Promise.mapOk(match[0], (function (param) {
                  socket.destroy();
                  return {
                          TAG: 1,
                          _0: port,
                          [Symbol.for("name")]: "ViaTCP"
                        };
                }));
  };
  if (tryTCP) {
    return $$Promise.flatMapError(probeTCP(port), (function (error) {
                  console.log("Got the following error when trying to connect to the Agda language server via TCP:", error);
                  return probeStdIO(name);
                }));
  } else {
    return probeStdIO(name);
  }
}

function start(tryTCP) {
  var match = singleton.contents;
  if (match) {
    return $$Promise.resolved({
                TAG: 0,
                _0: [
                  match._1,
                  match._0.method
                ],
                [Symbol.for("name")]: "Ok"
              });
  } else {
    return $$Promise.flatMap($$Promise.flatMapOk(probe(tryTCP, 4096, "als"), make$2), (function (result) {
                  if (result.TAG === /* Ok */0) {
                    var client = result._0;
                    return $$Promise.flatMapOk(sendRequestPrim(client, /* SYN */0), (function (response) {
                                  if (response.TAG !== /* ACK */0) {
                                    return $$Promise.resolved({
                                                TAG: 1,
                                                _0: {
                                                  TAG: 5,
                                                  _0: /* Initialize */0,
                                                  [Symbol.for("name")]: "LSP"
                                                },
                                                [Symbol.for("name")]: "Error"
                                              });
                                  }
                                  var version = response._0;
                                  singleton.contents = {
                                    _0: client,
                                    _1: version,
                                    [Symbol.for("name")]: "Connected"
                                  };
                                  return $$Promise.resolved({
                                              TAG: 0,
                                              _0: [
                                                version,
                                                client.method
                                              ],
                                              [Symbol.for("name")]: "Ok"
                                            });
                                }));
                  }
                  singleton.contents = /* Disconnected */0;
                  return $$Promise.resolved({
                              TAG: 1,
                              _0: result._0,
                              [Symbol.for("name")]: "Error"
                            });
                }));
  }
}

function getVersion$1(param) {
  var match = singleton.contents;
  if (match) {
    return match._1;
  }
  
}

function isConnected(param) {
  var match = singleton.contents;
  if (match) {
    return true;
  } else {
    return false;
  }
}

function sendRequest$2(request, handler) {
  var match = singleton.contents;
  if (!match) {
    return $$Promise.resolved({
                TAG: 1,
                _0: /* NotConnectedYet */0,
                [Symbol.for("name")]: "Error"
              });
  }
  var scheduler = make(undefined);
  var match$1 = $$Promise.pending(undefined);
  var resolve = match$1[1];
  var waitForResponseEnd = match$1[0];
  var subscription = new Vscode.Disposable(Chan$AgdaModeVscode.on(dataChan, (function (json) {
              var error = decodeResponse(json);
              if (error.TAG !== /* Ok */0) {
                return Curry._1(resolve, {
                            TAG: 1,
                            _0: error._0,
                            [Symbol.for("name")]: "Error"
                          });
              }
              var responese = error._0;
              if (typeof responese === "number") {
                return Curry._1(resolve, {
                            TAG: 0,
                            _0: undefined,
                            [Symbol.for("name")]: "Ok"
                          });
              }
              switch (responese.TAG | 0) {
                case /* ResponseNonLast */0 :
                    return runNonLast(scheduler, handler, responese._0);
                case /* ResponseLast */1 :
                    return addLast(scheduler, responese._0, responese._1);
                case /* ResponseParseError */2 :
                    return Curry._1(resolve, {
                                TAG: 1,
                                _0: {
                                  TAG: 6,
                                  _0: responese._0,
                                  [Symbol.for("name")]: "ResponseParseError"
                                },
                                [Symbol.for("name")]: "Error"
                              });
                
              }
            })));
  return $$Promise.tap($$Promise.tap($$Promise.flatMapOk(sendRequestPrim(match._0, {
                          _0: request,
                          [Symbol.for("name")]: "Command"
                        }), (function (result) {
                        if (result.TAG === /* ACK */0) {
                          return $$Promise.resolved({
                                      TAG: 1,
                                      _0: {
                                        TAG: 5,
                                        _0: /* Initialize */0,
                                        [Symbol.for("name")]: "LSP"
                                      },
                                      [Symbol.for("name")]: "Error"
                                    });
                        }
                        var error = result._0;
                        if (error !== undefined) {
                          return $$Promise.resolved({
                                      TAG: 1,
                                      _0: {
                                        TAG: 5,
                                        _0: {
                                          TAG: 1,
                                          _0: error,
                                          [Symbol.for("name")]: "SendCommand"
                                        },
                                        [Symbol.for("name")]: "LSP"
                                      },
                                      [Symbol.for("name")]: "Error"
                                    });
                        } else {
                          return waitForResponseEnd;
                        }
                      })), (function (param) {
                    subscription.dispose();
                    
                  })), (function (param) {
                return runLast(scheduler, handler);
              }));
}

var Module = {
  start: start,
  stop: stop,
  sendRequest: sendRequest$2,
  getVersion: getVersion$1,
  onError: onError,
  isConnected: isConnected
};

var LSP$1 = {
  CommandReq: CommandReq,
  CommandRes: CommandRes,
  LSPResponse: LSPResponse,
  Module: Module,
  start: start,
  stop: stop,
  sendRequest: sendRequest$2,
  getVersion: getVersion$1,
  onError: onError,
  isConnected: isConnected
};

exports.$$Error = $$Error;
exports.Scheduler = Scheduler;
exports.Emacs = Emacs;
exports.LSP = LSP$1;
/* decode Not a pure module */
